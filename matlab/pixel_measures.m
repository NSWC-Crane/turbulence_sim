format long g
format compact
clc
close all
clearvars

% get the location of the script file to save figures
full_path = mfilename('fullpath');
[startpath,  baseline_filename, ext] = fileparts(full_path);
plot_num = 1;

%% fill in the data
data = [...
    0.002500, 0.002381, 0.002232, 0.002103, 0.001984, 0.001806; ...
    0.002699, 0.002580, 0.002401, 0.002282, 0.002183, 0.001984; ...
    0.002977, 0.002798, 0.002600, 0.002431, 0.002361, 0.002163; ...
    0.003175, 0.002996, 0.002798, 0.002629, 0.002530, 0.002282; ...
    0.003373, 0.003175, 0.002996, 0.002818, 0.002679, 0.002421; ...
    0.003572, 0.003393, 0.003175, 0.002977, 0.002818, 0.002580; ...
    0.003770, 0.003572, 0.003373, 0.003175, 0.002996, 0.002778; ...
    0.004008, 0.003790, 0.003572, 0.003373, 0.003175, 0.002977; ...
    0.004217, 0.003969, 0.003770, 0.003572, 0.003373, 0.003175  ...
];

range = 600:50:1000;
zoom = [2000, 2500, 3000, 3500, 4000, 5000];

%% curve fit

% x --> zoom
% y --> range

% Linear model Poly23:
%      f(x,y) = p00 + p10*x + p01*y + p20*x^2 + p11*x*y + p02*y^2 + p21*x^2*y +
%                      p12*x*y^2 + p03*y^3
% Coefficients (with 95% confidence bounds):
%        p00 =   -0.003657  (-0.005607, -0.001706)
%        p10 =   4.707e-07  (1.169e-07, 8.245e-07)
%        p01 =   1.791e-05  (1.093e-05, 2.489e-05)
%        p20 =  -1.893e-11  (-5.593e-11, 1.808e-11)
%        p11 =   -1.84e-09  (-2.532e-09, -1.149e-09)
%        p02 =  -1.378e-08  (-2.229e-08, -5.26e-09)
%        p21 =   7.507e-14  (2.94e-14, 1.207e-13)
%        p12 =   6.222e-13  (2.397e-13, 1.005e-12)
%        p03 =   5.017e-12  (1.512e-12, 8.523e-12)
% 
% Goodness of fit:
%   SSE: 1.822e-08
%   R-square: 0.999
%   Adjusted R-square: 0.9988
%   RMSE: 2.012e-05
